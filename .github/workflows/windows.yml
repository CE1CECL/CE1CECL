name: Windows

on: workflow_dispatch

jobs:
  windows:

    runs-on: windows-2019
    timeout-minutes: 9999

    steps:
    - name: MKDIR.
      run: mkdir C:\CE1CECL\
    - name: Download.
      run: Invoke-WebRequest http://codeload.github.com/CE1CECL/CE1CECL/zip/refs/heads/CE1CECL -OutFile C:\CE1CECL\CE1CECL.zip
    - name: UnZip.
      run: Expand-Archive -Force C:\CE1CECL\CE1CECL.zip C:\CE1CECL\
    - name: Auth
      run: C:\CE1CECL\CE1CECL-CE1CECL\ngrok\ngrok-v3-stable-windows-amd64\ngrok.exe config add-authtoken ${{ secrets.SECRET_A }}
    - name: AddUser
      run: net user ${{ secrets.SECRET_B }} ${{ secrets.SECRET_C }} /ADD
    - name: ChPwd
      run: net user ${{ secrets.SECRET_B }} ${{ secrets.SECRET_C }}
    - name: AddGroup
      run: net localgroup ${{ secrets.SECRET_D }} ${{ secrets.SECRET_B }} /ADD
    - name: CE1CECL
      run: cmd /c C:\CE1CECL\CE1CECL-CE1CECL\CE1CECL.bat
